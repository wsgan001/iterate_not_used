# Rademacher 复杂度

TODO

- 这一章也没有整理

12.5 Rademacher复杂度

12.4节提到，基于VC维的泛化误差界是分布无关、数据独立的，也就是 说，对任何数据分布都成立.这使得基于VC维的可学习性分析结果具有一定 的“普适性”；但从另一方面来说，由于没有考虑数据自身，基于VC维得到 的泛化误差界通常比较“松”，对那些与学习问题的典型情况相差甚远的较 “坏”分布来说尤其如此.

这个名字是为了纪念 德国数学家H. Rademacher (1892-1969).


Rademacher复杂度(Rademacher complexity)是另一种刻画假设空间复 杂度的途径，与VC维不同的是，它在一定程度上考虑了数据分布.

给定训练集I? =    (扔,妁),…，ym)},假设打的经验误差为

- m

= ~    7^ yi)
m i=i

_ 丄 1 一 yjh(Xj)
1 l m
=2 ~    ，    (12.36)
2=1

其中去EZi yMxi)体现了预测值h(Xi)与样例真实标记队之间的一致性，若 对于所有i e {1，2,…，m}都有九(心)=队，则忐IXi yMxC取最大值i.也 就是说，经验误差最小的假设是



(12.37)

然而，现实任务中样例的标记有时会受到噪声影响，即对某些样例 其讲或许已受到随机因素的影响，不再是的真实标记.在此情形下，选择假 设空间丸中在训练集上表现最好的假设，有时还不如选择并中事先已考虑了 随机噪声影响的假设.

考虑随机变量它以0.5的概率取值-1，0.5的概率取值+1,称为

Rademacher随机变量.基于可将式(12.37)重写为
況是无限假设空间，有 可能取不到最大值，因此 使用上确界代替最大值.


1 m

sup — 5^ aih(Xi) .    (12.38)
考虑H中的所有假设:对式(12.38)取期望可得

1 m

Eo-^sup —    ,

(12.39)

其中a = {ai5a25...,am}.式(I2.39)的取值范围是［0，1］，它体现了假设空 间沢的表达能力，例如，当|州=1时，并中仅有一个假设，这时可计算出 式(12.39)的值为0;当|州=2W且W能打散D时，对任意a总有一个假设使 得h(xi) = ai (i = l，2,…，m)r这时可计算出式(l2.39)的值为1.

考虑实值函数空间Z: Z 4 R.令Z = {勿,勿，…，zm},其中知€冬将 式(12.39)中的义和片替换为Z和Z可得

定义12.8函数空间，关于Z的经验Rademacher复杂度

(12.40)
经验Rademacher复杂度衡量了函数空间J7与随祖噪声在集合Z中的相 关性.通常我们希望了解函数空间在艺上关于分布刃的相关性，因此，对所 有从P独立同分布采样而得的大小为m的集合Z求期望可得

定义12.9函数空间J•关于之上分布幻的Rademacher复杂度

Rm(^ = Ezcz：|z|=m ［知⑺j •    (12.41)
基于Rademacher复杂度可得关于函数空间的泛化误差界［Mohri et al., 2012］:
定理12.5对实值函数空间J-： 3^ ［0,1］5根据分布P从Z中独立同分 布采样得到示例集z = {zi,z2,...,zm}, e z, o < 5 < 1,对任意/ e 以
至少1 - 6的概率有

E[/H] <    +    +    ，    (12.42)

i=l

E[/W]    ⑷+ 成(，)+ 3^^^.    (12.43)

i=l

证明令

1 m

m i=i

少⑻= SUPE[/]-爲⑺， fe^

同时，令Zz为只与Z有一个示例不同的训练集，不妨设e Z和;4 e Z'为 不同示例，可得

少(Z’)- .(Z)=


JupE[/] -Ez\f})- (supE[/] -EZ(/))

彡呵)爲⑺-良，(/) fey

=sup    -

/e«F    rn

1

彡一• m

同理可得

毋⑻一 ^(/)    -,

m

|$(Z) —$(太)|彡丄.

m

根据McDiarmid不等式(12.7)可知，对任意5 e (0,1), (12.44)

$(Z)^Ez[^(Z)] +



以至少1 - d的概率成立.下面来估计EZ［^(Z)］的上界:

EZ[否⑻]=Ez[supE[/] - Ez(f)]
=Ez[supEz/ [心⑺-良(/)]]
利用Jensen不等式 (12.4)和上确界函数的凸 性.


(，岁［sup 五，⑺-


m


12 内(/(<)-/⑹)] 2=1

1 m    1 m
< [sup-^J a,/(z；)] +E^ [sup-£ -q/⑹] m


(Ti与—分布相同.



i=l


=22^(7*).
至此，式(12.42)得证.由定义12.9可知，改变Z中的一个示例对Rz(^)的值所 造成的改变最多为1/m.由］^001&11111(1不等式(12.7)可知，

Rm^)^ 知⑺ +    (12.45)
以至少1 - J/2的概率成立.再由式(12.44)可知，

$(z)eZ［$(z)］+

以至少1 -(5/2的概率成立.于是，

^)<2^(7-) + 3



(12.46)
以至少1 - 5的概率成立.至此，式(12.43)得证.    ■

需注意的是，定理12.5中的函数空间J•是区间［0,. 1］上的实值函数，因此 定理12.5只适用于回归问题.对二分类问题,我们有下面的定理：

—yi(H与分布相间.


定理12.6对假设空间沢：疋->{-1,+1},根据分布P从X中独立同分 布米样得到zpc例集 D =    吻,...，®m}5 E Af, 0 < 5 < 1,对任意 h € T~L,

以至少的概率有


迟㈨ < 取h) + RmW +    ,    (12.47)

五㈨ < 戰h) + RdW +    .    (12.48)

证明对二分类问题的假设空间札令Z =义x卜1，+1},则权中的假设 h变形为

fh(之)=fh(x，y) = 1(/^(®) y) j    (12.49)

于是就可将值域为{-15+1}的假设空间宄转化为值域为［0，1］的函数空间 J7U = {fh^he H}.由定义 12.8,有


1 m

Rz(^H)= Ea [ sup —    访)]


i=l


=Ecr


1 - yih(xj) 2 ,


1    1 m    1 m

= 2E" L g    Z (-餅一⑹)]

1 1 m

(- yiCTihixi)}^

1 -

=2Rd^ -


(12.50)


对式(12.50)求期望后可得

Rm^n) =    •    (12.51)

由定理12.5和式(12.50)〜(12.51)，定理12.6得证.    ■


定理12.6给出了基于Rademacher复杂度的泛化误差界.与定理12.3对比 可知，基于VC维的泛化误差界是分布无关、数据独立的，而基于Rademacher 复杂度的泛化误差界(12.47)与分布2?有关，式(12.48)与数据D有关.换言之， 基于Rademacher复杂度的泛化误差界依赖于具体学习何题上的数据分布，有 点类似于为该学习问题“量身定制”的，因此它通常比基于VC维的泛化误差 界更紧一些.

值得一提的是，关于Rademacher复杂度与増长函数，有如下定理：

证明过程参阅［Mohri et al., 2012】.


定理12.7 假设空间丸的Rademacher复杂度丑^⑺)与增长函数 满足

.    (12.52)
V m

由式(12.47)，(12.52)和推论12.2可得
雌)dm @5+^，    (12.53)
也就是说，我们从Rademacher复杂度和增长函数能推导出基于VC维的泛化 误差界.



## REF

1. 《机器学习》周志华
